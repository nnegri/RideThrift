{% extends 'base.html' %}
{% block content %}

    <h1>Ride Thrift</h2>

    <form id="estimate-form" method="post" action="/estimates.json">
        <label>Origin:</label>

        <input type="hidden" class="origin-lat" name="origin-lat" id="orig-lat" value="origin"> 
        <input type="hidden" class="origin-lng" name="origin-lng" id="orig-lng" value="origin">

        <div id="locationField">
            <input class = "auto" id="autocomplete-orig" placeholder="Enter your address"
             onFocus="geolocate()" type="text"></input>
        </div>


        {% if session %}
            <select name="origins" id="origin-drop">
                <option value="-">Saved Addresses
                {% for user_address in user.user_addresses %}
                    <option value="{{ user_address.address.house_number }} {{ user_address.address.street }} {{ user_address.address.city }}" data-lat="{{ user_address.address.latitude }}" data-lng="{{ user_address.address.longitude }}" data-format="{{ user_address.label }}">{{ user_address.label }}
                {% endfor %}
            </select>
        {% endif %}
        <br>
        <label>Destination:</label>

        <input type="hidden" class="destn-lat" name="dest-lat" id="dest-lat" value="dest"> 
        <input type="hidden" class="destn-lng" name="dest-lng" id="dest-lng" value="dest">

        <div id="locationField">
            <input class = "auto" id="autocomplete-dest" placeholder="Enter your address"
             onFocus="geolocate()" type="text"></input>
        </div>

        {% if session %}
            <select name="dests" id="dest-drop">
                <option value="-">Saved Addresses
                {% for user_address in user.user_addresses %}
                    <option value="{{ user_address.address.house_number }} {{ user_address.address.street }} {{ user_address.address.city }}" data-lat="{{ user_address.address.latitude }}" data-lng="{{ user_address.address.longitude }}" data-format="{{ user_address.address.house_number }} {{ user_address.address.street }}, {{ user_address.address.city }}">{{ user_address.label }}
                {% endfor %}
            </select>
        {% endif %}
        <br><input type="submit" value="Get Estimates"><br>    
        {% if session %}    
                <br><input type="submit" value="Save Address" id="save-add"><br>         
        {% endif %}
    </form>
    <ul><span id="uber"></span>
        <li id="pool"></li>
        <li id="uberx"></li>
        <li id="uberxl"></li>
    </ul>

    <ul><span id="lyft"></span>
        <li id="line"></li>
        <li id="lyft-lyft"></li>
        <li id="plus"></li>
    </ul>


    <!-- Modal Window -->

    <div class="modal fade bs-example-modal-sm" tabindex="-1" role="dialog" aria-labelledby="mySmallModalLabel" id="save-add-modal">
      <div class="modal-dialog modal-sm">
            <div class="modal-content">
                <form id="save-origin" method="post" action="/address-saved">
                    <p class="origin-address" id="or-formatted-address"></p> 
                    <input type="hidden" class="origin-lat" name="origin-lat" id="orig-lat">
                    <input type="hidden" class="origin-lng" name="origin-lng" id="orig-lng">
                    <input type="hidden" name="origin-house-num" id="origin-house-num">
                    <input type="hidden" name="origin-street" id="origin-street">
                    <input type="hidden" name="origin-city" id="origin-city">
                    <input type="hidden" name="origin-state" id="origin-state">
                    <input type="hidden" name="origin-postal" id="origin-postal">
                    <!-- <input type="hidden" name="origin-array" id="orig-arr"> -->
                    <input type="checkbox" name="origin" value="save" id="orig-check" checked="checked">
                    Label: <input type="text" name="label-or" id="label"><br>
                    <p class="dest-address" id="de-formatted-address"></p> 
                    <input type="hidden" class="destn-lat" name="dest-lat" id="dest-lat">
                    <input type="hidden" class="destn-lng" name="dest-lng" id="dest-lng">
                    <input type="hidden" name="destn-house-num" id="destn-house-num">
                    <input type="hidden" name="destn-street" id="destn-street">
                    <input type="hidden" name="destn-city" id="destn-city">
                    <input type="hidden" name="destn-state" id="destn-state">
                    <input type="hidden" name="destn-postal" id="destn-postal">
                    <!-- <input type="hidden" name="dest-array" id="dest-arr"> -->
                    <input type="checkbox" name="dest" value="save" id="dest-check" checked="checked">
                    Label: <input type="text" name="label-de" id="label"><br>
                    <input type="submit" value="Save" id="save-address">
                </form>
    <a href="/">Cancel</a>

    <script type="text/javascript">
        "use strict";


        $(document).on("click", "#save-add", function() {
            $("#save-add-modal").modal("show");
            // $("#save-address").prop("disabled", true);
        });

        $("#orig-check").on("change", function (evt) {
            // $("#save-address").prop("disabled", false);
            $("#orig-lat").attr("value", "");
            $("#orig-lng").attr("value", "");
            $("#orig-array").attr("value", "");
        });

        $("#dest-check").on("change", function (evt) {
            // $("#save-address").prop("disabled", false);
            $("#dest-lat").attr("value", "");
            $("#dest-lng").attr("value", "");
            $("#dest-array").attr("value", "");
        });

    </script>

            </div>
        </div>
    </div>



    <script src="https://maps.googleapis.com/maps/api/js?key=AIzaSyDONgg2Pw6W0awiwVNAVRD0HTK6Hzz2OA4&libraries=places&callback=initAutocomplete" async defer></script>
    <script src="/static/js/submit-addresses.js"></script>


{% endblock %}